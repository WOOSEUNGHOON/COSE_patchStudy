462c3ca1db53ed3cfc394cf5948e9c948ad1c10e
sinatra@@sinatra@@pull@@1683
diff --git a/lib/sinatra/base.rb b/lib/sinatra/base.rb
index 8f0d00c7c..4b5fbb0ce 100644
--- a/lib/sinatra/base.rb
+++ b/lib/sinatra/base.rb
@@ -1090,6 +1090,7 @@ def static!(options = {})
       return unless valid_path?(path)
 
       path = File.expand_path(path)
+      return unless path.start_with?(File.expand_path(public_dir) + '/')
       return unless File.file?(path)
 
       env['sinatra.static_file'] = path
diff --git a/test/static_test.rb b/test/static_test.rb
index 71ed5eb05..cefe55f9c 100644
--- a/test/static_test.rb
+++ b/test/static_test.rb
@@ -97,6 +97,7 @@ class StaticTest < Minitest::Test
     mock_app do
       set :static, true
       set :public_folder, __dir__ + '/data'
+      disable :protection
     end
     get "/../#{File.basename(__FILE__)}"
     assert not_found?
