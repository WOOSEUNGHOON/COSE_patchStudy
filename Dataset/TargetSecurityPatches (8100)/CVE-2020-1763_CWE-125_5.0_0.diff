471a3e41a449d7c753bc4edbba4239501bb62ba8
libreswan@@libreswan
diff --git a/programs/pluto/ikev1.c b/programs/pluto/ikev1.c
index 78d5c3eca1..244b00f5cc 100644
--- a/programs/pluto/ikev1.c
+++ b/programs/pluto/ikev1.c
@@ -2129,7 +2129,7 @@ void process_packet_tail(struct msg_digest *md)
 						"%smessage ignored because it contains a payload type (%s) unexpected by state %s",
 						excuse,
 						enum_show(&ikev1_payload_names, np),
-						st->st_state->name);
+						finite_states[smc->state]->name);
 					if (!md->encrypted) {
 						SEND_NOTIFICATION(INVALID_PAYLOAD_TYPE);
 					}
