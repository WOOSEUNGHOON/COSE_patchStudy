19189a91d1eac9aa204b9439b82e3e73c8ac2e03
chamilo@@chamilo-lms
diff --git a/main/document/document.php b/main/document/document.php
index 9ebfeeac5e2..17837084b75 100755
--- a/main/document/document.php
+++ b/main/document/document.php
@@ -1995,7 +1995,7 @@ function convertModal (id, format) {
             );
 
             // Document title with link and comment
-            $titleWithLink = $link.$session_img.''.$invisibility_span_open;
+            $titleWithLink = Security::remove_XSS($link.$session_img.''.$invisibility_span_open);
             $commentText = nl2br(htmlspecialchars($document_data['comment'], ENT_QUOTES, $charset));
             if (!empty($commentText)) {
                 $titleWithLink .= ''.$commentText.'';
