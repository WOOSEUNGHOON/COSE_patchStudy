48b5ca812a89689fd2f32248875cedcba8c9014f
funzoneq@@freshdns@@pull@@6
diff --git a/js/freshdns.js b/js/freshdns.js
index 93209c7..a2c99c4 100644
--- a/js/freshdns.js
+++ b/js/freshdns.js
@@ -277,11 +277,11 @@ function editDomainWindow (request)
 			{
 				var r = jsonData.records[i];
 				result += '';
-				result += '';
-				result += '';
-				result += '';
-				result += '';
-				result += '';
+				result += '';
+				result += '';
+				result += '';
+				result += '';
+				result += '';
 				result += '';
 				result += '';
+			result += '    ';
 			result += '    A';
 			result += '    AAAACNAME';
 			result += '    HINFOMX';
@@ -306,7 +306,7 @@ function editDomainWindow (request)
 			result += '    PTRSOA';
 			result += '    TXTURL';
 			result += '    SRVMBOXFW';
-			result += '	   ';
+			result += '	   ';
 			result += '	   ';
 			result += '	   ';
 			result += '	   delete user ]';
-				result += '  '+jsonData[i].fullname+'';
+				result += '  '+jsonData[i].fullname.escapeHTML()+'';
 				result += '  '+jsonData[i].level+'';
 				result += '';
 			}
@@ -610,11 +610,11 @@ function showEditUser (request)
 		if(!editUser_u2ftokens || !editUser_u2ftokens.length) editUser_u2ftokens=[];
 
 		var result = 'Edit user :: '+jsonData.username+'';
-		result += 'Username';
+		result += 'Username';
 		result += 'Password';
-		result += 'Full name';
-		result += 'E-mail';
-		result += 'Description'+jsonData.description+'';
+		result += 'Full name';
+		result += 'E-mail';
+		result += 'Description'+jsonData.description.escapeHTML()+'';
 		result += 'Max domains';
 		result += 'Level';
 		result += 'Active';
@@ -624,7 +624,7 @@ function showEditUser (request)
 		for(var i=0; i="+token[key]+"";
+			for(var key in token) if (token.hasOwnProperty(key)) result += ""+key.escapeHTML()+"="+token[key].escapeHTML()+"";
 			result += "";
 		}
 		result += "";
diff --git a/js/prototype.js b/js/prototype.js
index 614ef77..8e0d12c 100755
--- a/js/prototype.js
+++ b/js/prototype.js
@@ -157,10 +157,7 @@ Object.extend(String.prototype, {
   },

 

   escapeHTML: function() {

-    var div = document.createElement('div');

-    var text = document.createTextNode(this);

-    div.appendChild(text);

-    return div.innerHTML;

+    return this.replace(/'/g, "'").replace(/"/g, """).replace(//g, ">");

   },

 

   unescapeHTML: function() {

