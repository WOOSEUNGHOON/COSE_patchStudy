a117dacde0288f3ec60b6e5bcedae8fa37ee0dfc
torvalds@@linux
diff --git a/drivers/net/tun.c b/drivers/net/tun.c
index c62163e272cd85..f55c46222613f0 100644
--- a/drivers/net/tun.c
+++ b/drivers/net/tun.c
@@ -1379,9 +1379,11 @@ static long __tun_chr_ioctl(struct file *file, unsigned int cmd,
 	int vnet_hdr_sz;
 	int ret;
 
-	if (cmd == TUNSETIFF || _IOC_TYPE(cmd) == 0x89)
+	if (cmd == TUNSETIFF || _IOC_TYPE(cmd) == 0x89) {
 		if (copy_from_user(ùî¶, argp, ifreq_len))
 			return -EFAULT;
+	} else
+		memset(ùî¶, 0, sizeof(ifr));
 
 	if (cmd == TUNGETFEATURES) {
 		/* Currently this just means: "what IFF flags are valid?".
