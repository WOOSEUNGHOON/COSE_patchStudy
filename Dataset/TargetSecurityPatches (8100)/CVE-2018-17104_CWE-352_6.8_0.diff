982ea9d5efb7d2306a05644ebc3469dadb33767e
microweber@@microweber
diff --git a/src/Microweber/Providers/UserManager.php b/src/Microweber/Providers/UserManager.php
index 93225ffc08..12db014d1a 100644
--- a/src/Microweber/Providers/UserManager.php
+++ b/src/Microweber/Providers/UserManager.php
@@ -646,6 +646,7 @@ public function register($params)
         }
 
         if (defined('MW_API_CALL')) {
+
             if (isset($params['is_admin']) and $this->is_admin() == false) {
                 unset($params['is_admin']);
             }
@@ -901,6 +902,21 @@ public function save($params)
             }
         }
         if ($force == false) {
+
+            if (isset($params['id'])) {
+                $validate_token = mw()->user_manager->csrf_validate($params);
+
+                if ($validate_token == false) {
+
+                    return array(
+                        'error' => _e('Confirm edit of profile', true),
+                        'form_data_required' => 'token',
+                        'form_data_module' => 'users/profile/confirm_edit'
+                    );
+
+                }
+            }
+
             if (isset($params['id']) and $params['id'] != 0) {
                 $adm = $this->is_admin();
                 if ($adm == false) {
@@ -923,6 +939,9 @@ public function save($params)
                             return array('error' => 'You must be logged save your settings');
                         }
                     } else {
+
+
+
                         if (!isset($params['id'])) {
                             $params['id'] = $this->id();
                         }
diff --git a/userfiles/modules/users/edit_user.php b/userfiles/modules/users/edit_user.php
index f181af17b8..df7bf1065e 100644
--- a/userfiles/modules/users/edit_user.php
+++ b/userfiles/modules/users/edit_user.php
@@ -186,7 +186,8 @@
     


-        
+        
+        



diff --git a/userfiles/modules/users/profile/confirm_edit.php b/userfiles/modules/users/profile/confirm_edit.php
new file mode 100644
index 0000000000..57df260f3c
--- /dev/null
+++ b/userfiles/modules/users/profile/confirm_edit.php
@@ -0,0 +1,11 @@
+
+    
+        
+            
+            
+                 Â 
+                
+            
+        
+    
+
\ No newline at end of file
