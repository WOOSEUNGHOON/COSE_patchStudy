db7ca53
owncloud@@core
diff --git a/apps/files_encryption/settings.php b/apps/files_encryption/settings.php
index 0a0d4d1abbad..8594cfc44ec4 100644
--- a/apps/files_encryption/settings.php
+++ b/apps/files_encryption/settings.php
@@ -6,6 +6,8 @@
  * See the COPYING-README file.
  */
 
+OC_Util::checkAdminUser();
+
 $tmpl = new OCP\Template( 'files_encryption', 'settings');
 $blackList=explode(',',OCP\Config::getAppValue('files_encryption','type_blacklist','jpg,png,jpeg,avi,mpg,mpeg,mkv,mp3,oga,ogv,ogg'));
 $enabled=(OCP\Config::getAppValue('files_encryption','enable_encryption','true')=='true');
diff --git a/apps/files_external/settings.php b/apps/files_external/settings.php
index 94222149a38e..16568cb8069e 100644
--- a/apps/files_external/settings.php
+++ b/apps/files_external/settings.php
@@ -20,6 +20,8 @@
 * License along with this library.  If not, see .
 */
 
+OC_Util::checkAdminUser();
+
 OCP\Util::addScript('files_external', 'settings');
 OCP\Util::addscript('3rdparty', 'chosen/chosen.jquery.min');
 OCP\Util::addStyle('files_external', 'settings');
diff --git a/apps/user_ldap/settings.php b/apps/user_ldap/settings.php
index f9ad2db94a02..8de4e7114682 100644
--- a/apps/user_ldap/settings.php
+++ b/apps/user_ldap/settings.php
@@ -20,6 +20,9 @@
  * License along with this library.  If not, see .
  *
  */
+
+OC_Util::checkAdminUser();
+
 $params = array('ldap_host', 'ldap_port', 'ldap_dn', 'ldap_agent_password', 'ldap_base', 'ldap_base_users', 'ldap_base_groups', 'ldap_userlist_filter', 'ldap_login_filter', 'ldap_group_filter', 'ldap_display_name', 'ldap_group_display_name', 'ldap_tls', 'ldap_turn_off_cert_check', 'ldap_nocase', 'ldap_quota_def', 'ldap_quota_attr', 'ldap_email_attr', 'ldap_group_member_assoc_attribute', 'ldap_cache_ttl', 'home_folder_naming_rule');
 
 OCP\Util::addscript('user_ldap', 'settings');
diff --git a/apps/user_webdavauth/settings.php b/apps/user_webdavauth/settings.php
index 497a3385caa6..5f1470aa5cbe 100755
--- a/apps/user_webdavauth/settings.php
+++ b/apps/user_webdavauth/settings.php
@@ -21,6 +21,8 @@
  *
  */
 
+OC_Util::checkAdminUser();
+
 if($_POST) {
 
 		if(isset($_POST['webdav_url'])) {
