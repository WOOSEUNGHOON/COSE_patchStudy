8dec044d0fdabcb9b04e58037623385a97b0d288
sauruscms@@Saurus-CMS-Community-Edition
diff --git a/admin/error_log.php b/admin/error_log.php
index 7a39f86..dd58286 100644
--- a/admin/error_log.php
+++ b/admin/error_log.php
@@ -103,7 +103,10 @@
 

 		


-	fdat as $fdat_field=>$fdat_value) { ?>

+	fdat as $fdat_field=>$fdat_value) {

+	$fdat_value = htmlspecialchars(xss_clean($fdat_value));

+	$fdat_field = htmlspecialchars(xss_clean($fdat_field)); 

+	?>

 		



@@ -112,7 +115,7 @@
 		

 		
sys_sona(array(sona => "otsi", tyyp=>"editor")); ?>

-	          

+	          


 

diff --git a/admin/profile_data.php b/admin/profile_data.php
index c6c58f1..36398ab 100644
--- a/admin/profile_data.php
+++ b/admin/profile_data.php
@@ -173,14 +173,14 @@
 									


-									

+									





-		

-		

+		

+		




diff --git a/classes/user_html.inc.php b/classes/user_html.inc.php
index b15d97e..55dd639 100644
--- a/classes/user_html.inc.php
+++ b/classes/user_html.inc.php
@@ -621,6 +621,11 @@ function print_search_box(){
 	$site->fdat['user_search'] = isset($site->fdat['user_search']) ? $site->fdat['user_search'] : "1";

 	$site->fdat['group_search'] = isset($site->fdat['group_search']) ? $site->fdat['group_search'] : "1";

 

+	$site->fdat['search_subtree'] = htmlspecialchars(xss_clean($site->fdat['search_subtree']));

+	$site->fdat['user_search'] = htmlspecialchars(xss_clean($site->fdat['user_search']));

+	$site->fdat['group_search'] = htmlspecialchars(xss_clean($site->fdat['group_search']));

+	$site->fdat['search'] = htmlspecialchars(xss_clean($site->fdat['search']));

+

 	$out = '

 			

