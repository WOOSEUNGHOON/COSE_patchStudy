9443258724e84cb388aa1865b775beaecd80596d
mantisbt@@mantisbt
diff --git a/manage_proj_cat_delete.php b/manage_proj_cat_delete.php
index 59ea3374b8..d3f6f7f279 100644
--- a/manage_proj_cat_delete.php
+++ b/manage_proj_cat_delete.php
@@ -60,12 +60,12 @@
 $f_category_id = gpc_get_int( 'id' );
 $f_project_id = gpc_get_int( 'project_id' );
 
-access_ensure_project_level( config_get( 'manage_project_threshold' ), $f_project_id );
-
 $t_row = category_get_row( $f_category_id );
 $t_name = category_full_name( $f_category_id );
 $t_project_id = $t_row['project_id'];
 
+access_ensure_project_level( config_get( 'manage_project_threshold' ), $t_project_id );
+
 # Get a bug count
 $t_bug_table = db_get_table( 'bug' );
 $t_query = "SELECT COUNT(id) FROM $t_bug_table WHERE category_id=" . db_param();
diff --git a/manage_proj_cat_edit_page.php b/manage_proj_cat_edit_page.php
index 89f69327f1..a6e2d4c6df 100644
--- a/manage_proj_cat_edit_page.php
+++ b/manage_proj_cat_edit_page.php
@@ -55,13 +55,13 @@
 $f_category_id		= gpc_get_int( 'id' );
 $f_project_id		= gpc_get_int( 'project_id' );
 
-access_ensure_project_level( config_get( 'manage_project_threshold' ), $f_project_id );
-
 $t_row = category_get_row( $f_category_id );
 $t_assigned_to = $t_row['user_id'];
 $t_project_id = $t_row['project_id'];
 $t_name = $t_row['name'];
 
+access_ensure_project_level( config_get( 'manage_project_threshold' ), $t_project_id );
+
 html_page_top();
 
 print_manage_menu( 'manage_proj_cat_edit_page.php' ); ?>
diff --git a/manage_proj_page.php b/manage_proj_page.php
index 681e490245..4cbbca4141 100644
--- a/manage_proj_page.php
+++ b/manage_proj_page.php
@@ -164,20 +164,25 @@
 	
 0 ) { ?>
 		


+			

+			

>
 			

+			



+			


 
+



@@ -200,6 +207,7 @@
 			


+

 
 <?php
