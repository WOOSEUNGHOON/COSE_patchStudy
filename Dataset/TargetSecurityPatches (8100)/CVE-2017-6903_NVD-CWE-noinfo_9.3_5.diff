376267d534476a875d8b9228149c4ee18b74a4fd
ioquake@@ioq3
diff --git a/code/client/cl_console.c b/code/client/cl_console.c
index 7d806e947a..32ab87e037 100644
--- a/code/client/cl_console.c
+++ b/code/client/cl_console.c
@@ -191,6 +191,12 @@ void Con_Dump_f (void)
 	Q_strncpyz( filename, Cmd_Argv( 1 ), sizeof( filename ) );
 	COM_DefaultExtension( filename, sizeof( filename ), ".txt" );
 
+	if (!COM_CompareExtension(filename, ".txt"))
+	{
+		Com_Printf("Con_Dump_f: Only the \".txt\" extension is supported by this command!\n");
+		return;
+	}
+
 	f = FS_FOpenFileWrite( filename );
 	if (!f)
 	{
diff --git a/code/qcommon/common.c b/code/qcommon/common.c
index db9b435fb7..f3cf1214ce 100644
--- a/code/qcommon/common.c
+++ b/code/qcommon/common.c
@@ -2975,6 +2975,13 @@ void Com_WriteConfig_f( void ) {
 		return;
 	}
 
+
+	if (!COM_CompareExtension(filename, ".cfg"))
+	{
+		Com_Printf("Com_WriteConfig_f: Only the \".cfg\" extension is supported by this command!\n");
+		return;
+	}
+
 	Q_strncpyz( filename, Cmd_Argv(1), sizeof( filename ) );
 	COM_DefaultExtension( filename, sizeof( filename ), ".cfg" );
 	Com_Printf( "Writing %s.\n", filename );
