a220a22a8c05c10a7b875ac6b565f2c4fe7b251c
pfsense@@pfsense
diff --git a/src/usr/local/www/load_balancer_monitor.php b/src/usr/local/www/load_balancer_monitor.php
index 7dda71f6870..91d3c7978c9 100644
--- a/src/usr/local/www/load_balancer_monitor.php
+++ b/src/usr/local/www/load_balancer_monitor.php
@@ -113,13 +113,13 @@
 ?>
 					

-							
+							


-							
+							


-							
+							



diff --git a/src/usr/local/www/load_balancer_monitor_edit.php b/src/usr/local/www/load_balancer_monitor_edit.php
index 4e811b83502..4b55492569b 100644
--- a/src/usr/local/www/load_balancer_monitor_edit.php
+++ b/src/usr/local/www/load_balancer_monitor_edit.php
@@ -29,6 +29,14 @@
 
 require_once("guiconfig.inc");
 
+$types = array(
+	"icmp" => gettext("ICMP"),
+	"tcp" => gettext("TCP"),
+	"http" => gettext("HTTP"),
+	"https" => gettext("HTTPS"),
+	"send" => gettext("Send/Expect")
+);
+
 $referer = (isset($_SERVER['HTTP_REFERER']) ? $_SERVER['HTTP_REFERER'] : '/load_balancer_monitor.php');
 
 init_config_arr(array('load_balancer', 'monitor_type'));
@@ -84,6 +92,9 @@
 		}
 	}
 
+	if (!array_key_exists($_POST['type'], $types)) {
+		$input_errors[] = gettext("Select a valid monitor type.");
+	}
 	if (preg_match('/[ \/]/', $_POST['name'])) {
 		$input_errors[] = gettext("Spaces or slashes cannot be used in the 'name' field.");
 	}
@@ -194,7 +205,6 @@
 $shortcut_section = "relayd";
 
 include("head.inc");
-$types = array("icmp" => gettext("ICMP"), "tcp" => gettext("TCP"), "http" => gettext("HTTP"), "https" => gettext("HTTPS"), "send" => gettext("Send/Expect"));
 
 ?>
 
