c947975a4f1ff7bbfd7d5cd24a2e16bf12bd96d4
Enalean@@tuleap
diff --git a/plugins/docman/include/Docman_Widget_MyDocmanSearch.class.php b/plugins/docman/include/Docman_Widget_MyDocmanSearch.class.php
index 047e49bd442..bfb020ab3a2 100644
--- a/plugins/docman/include/Docman_Widget_MyDocmanSearch.class.php
+++ b/plugins/docman/include/Docman_Widget_MyDocmanSearch.class.php
@@ -83,7 +83,10 @@ public function getContent()
                 $itemPerm = $dPm->userCanAccess($user, $docman_id);
 
                 if ($itemPerm) {
-                    $html .= 'Show "' . $res['title'] . '" Properties';
+                    $purifier = Codendi_HTMLPurifier::instance();
+                    $html    .= 'Show "';
+                    $html    .=  $purifier->purify($res['title']);
+                    $html    .= '" Properties';
                     return $html;
                 }
             }
diff --git a/plugins/docman/include/view/Docman_View_Admin_LockInfos.class.php b/plugins/docman/include/view/Docman_View_Admin_LockInfos.class.php
index a9a4cfbb95e..e2374cb13d1 100644
--- a/plugins/docman/include/view/Docman_View_Admin_LockInfos.class.php
+++ b/plugins/docman/include/view/Docman_View_Admin_LockInfos.class.php
@@ -114,12 +114,16 @@ private function getTable($params)
                 }
                 $parent   = $dIF->getItemFromDb($item->getParentId());
                 $content .= '';
-                $content .= '' . '' . $item->getTitle() . '';
+                $content .= '' . '';
+                $content .= $hp->purify($item->getTitle());
+                $content .= '';
                 $content .= '';
                 if ($parent === null || $dIF->isRoot($parent)) {
                     $content .= '';
                 } else {
-                    $content .=  '' . $parent->getTitle() . '';
+                    $content .=  '';
+                    $content .= $hp->purify($parent->getTitle());
+                    $content .= '';
                 }
                 $content .= '' . $hp->purify($uH->getDisplayNameFromUserId($row['user_id'])) . '';
                 $content .= '' . format_date($GLOBALS['Language']->getText('system', 'datefmt'), $row['lock_date']) . '';
