050fea86cc162f3da2f7824f586602125a0f6d63
litecart@@litecart
diff --git a/public_html/admin/catalog.app/edit_category.inc.php b/public_html/admin/catalog.app/edit_category.inc.php
index b3633b802..d5d7a47de 100644
--- a/public_html/admin/catalog.app/edit_category.inc.php
+++ b/public_html/admin/catalog.app/edit_category.inc.php
@@ -255,7 +255,7 @@
                 


-                
+                



diff --git a/public_html/admin/catalog.app/edit_product.inc.php b/public_html/admin/catalog.app/edit_product.inc.php
index 9445a1783..e5ff96bc4 100644
--- a/public_html/admin/catalog.app/edit_product.inc.php
+++ b/public_html/admin/catalog.app/edit_product.inc.php
@@ -433,9 +433,9 @@ functions::draw_lightbox();
                 


-                
-                
-                
+                
+                
+                



@@ -747,7 +747,7 @@ functions::draw_lightbox();
                 


-                    
+                    



diff --git a/public_html/admin/countries.app/edit_country.inc.php b/public_html/admin/countries.app/edit_country.inc.php
index d4b1e22b4..e0398d453 100644
--- a/public_html/admin/countries.app/edit_country.inc.php
+++ b/public_html/admin/countries.app/edit_country.inc.php
@@ -171,7 +171,7 @@
         


-            
+            



diff --git a/public_html/admin/geo_zones.app/edit_geo_zone.inc.php b/public_html/admin/geo_zones.app/edit_geo_zone.inc.php
index 16bf3d3cb..a3f81b269 100644
--- a/public_html/admin/geo_zones.app/edit_geo_zone.inc.php
+++ b/public_html/admin/geo_zones.app/edit_geo_zone.inc.php
@@ -102,10 +102,10 @@
         


-            
-             name; ?>
-             zones[$_POST['zones'][$key]['zone_code']]['name'] : '-- '.language::translate('title_all_zones', 'All Zones') .' --'; ?>
-             
+            
+             name); ?>
+             zones[$_POST['zones'][$key]['zone_code']]['name']) : '-- '.language::translate('title_all_zones', 'All Zones') .' --'; ?>
+             



diff --git a/public_html/admin/orders.app/edit_order.inc.php b/public_html/admin/orders.app/edit_order.inc.php
index d1f8c2c3e..4e5bcd990 100644
--- a/public_html/admin/orders.app/edit_order.inc.php
+++ b/public_html/admin/orders.app/edit_order.inc.php
@@ -569,7 +569,7 @@ functions::draw_lightbox();
                 

 
-                
+                

 
@@ -610,7 +610,7 @@ functions::draw_lightbox();
               


-                   'catalog', 'doc' => 'edit_product', 'product_id' => $_POST['items'][$key]['product_id']]) .'" target="_blank">'. $_POST['items'][$key]['name'] .'' : $_POST['items'][$key]['name']; ?>  $_POST['items'][$key]['product_id']]) .'" target="_blank">'. functions::draw_fonticon('fa-external-link') .''; ?>
+                   'catalog', 'doc' => 'edit_product', 'product_id' => $_POST['items'][$key]['product_id']]) .'" target="_blank">'. functions::escape_html($_POST['items'][$key]['name']) .'' : functions::escape_html($_POST['items'][$key]['name']); ?>  $_POST['items'][$key]['product_id']]) .'" target="_blank">'. functions::draw_fonticon('fa-external-link') .''; ?>
                   


@@ -628,16 +628,16 @@ functions::draw_lightbox();
       if (!empty($_POST['items'][$key]['options'])) {
         foreach (array_keys($_POST['items'][$key]['options']) as $field) {
           echo '' . PHP_EOL
-             . ' - '. $field .': ' . PHP_EOL;
+             . ' - '. functions::escape_html($field) .': ' . PHP_EOL;
           if (is_array($_POST['items'][$key]['options'][$field])) {
             $use_comma = false;
             foreach (array_keys($_POST['items'][$key]['options'][$field]) as $k) {
-              echo '  ' . functions::form_draw_hidden_field('items['.$key.'][options]['.$field.']['.$k.']', true) . $_POST['items'][$key]['options'][$field][$k];
+              echo '  ' . functions::form_draw_hidden_field('items['.$key.'][options]['.$field.']['.$k.']', true) . functions::escape_html($_POST['items'][$key]['options'][$field][$k]);
               if ($use_comma) echo ', ';
               $use_comma = true;
             }
           } else {
-            echo '  ' . functions::form_draw_hidden_field('items['.$key.'][options]['.$field.']', true) . $_POST['items'][$key]['options'][$field];
+            echo '  ' . functions::form_draw_hidden_field('items['.$key.'][options]['.$field.']', true) . functions::escape_html($_POST['items'][$key]['options'][$field]);
           }
           echo '' . PHP_EOL;
         }
@@ -646,12 +646,12 @@ functions::draw_lightbox();
       }
 ?>
               
-              
+              

-                 
+                 


-                 x  x  
+                 x  x  



diff --git a/public_html/admin/orders.app/orders.inc.php b/public_html/admin/orders.app/orders.inc.php
index f461d4242..a937ac8f1 100644
--- a/public_html/admin/orders.app/orders.inc.php
+++ b/public_html/admin/orders.app/orders.inc.php
@@ -282,7 +282,7 @@
             


-            ('. language::translate('title_guest', 'Guest') .')' : ''; ?> 
+            ('. language::translate('title_guest', 'Guest') .')' : ''; ?> 
name : ''; ?>


diff --git a/public_html/admin/reports.app/most_shopping_customers.inc.php b/public_html/admin/reports.app/most_shopping_customers.inc.php
index 0c95636a7..cbc902c97 100644
--- a/public_html/admin/reports.app/most_shopping_customers.inc.php
+++ b/public_html/admin/reports.app/most_shopping_customers.inc.php
@@ -106,7 +106,7 @@
       


-           'customers', 'doc' => 'edit_customer', 'customer_id' => $customer['id']]) .'">'. $customer['name'] .'' : $customer['name'] .' ('. language::translate('title_guest', 'Guest') .')'; ?>
+           'customers', 'doc' => 'edit_customer', 'customer_id' => $customer['id']]) .'">'. functions::escape_html($customer['name']) .'' : functions::escape_html($customer['name']) .' ('. language::translate('title_guest', 'Guest') .')'; ?>



diff --git a/public_html/includes/templates/default.catalog/pages/order.inc.php b/public_html/includes/templates/default.catalog/pages/order.inc.php
index 4f3e90e10..56b44ad55 100644
--- a/public_html/includes/templates/default.catalog/pages/order.inc.php
+++ b/public_html/includes/templates/default.catalog/pages/order.inc.php
@@ -42,7 +42,7 @@
   


-      
+      



