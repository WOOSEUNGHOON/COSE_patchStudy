b4dcbba7a8eb09ba9d38fc69807a8861255736d0
ossec@@ossec-wui
diff --git a/site/search.php b/site/search.php
index ddc852a..87e5c7f 100644
--- a/site/search.php
+++ b/site/search.php
@@ -9,7 +9,7 @@
  * License (version 3) as published by the FSF - Free Software
  * Foundation
  */
-       
+
 /* OS PHP init */
 if (!function_exists('os_handle_start'))
 {
@@ -54,7 +54,7 @@
 /* Getting search id */
 if(isset($_POST['searchid']))
 {
-    if(preg_match('/[a-z0-9]+/', $_POST['searchid']))
+    if(preg_match('/^[a-z0-9]+$/', $_POST['searchid']))
     {
         $USER_searchid = $_POST['searchid'];
     }
@@ -99,7 +99,7 @@
 /* Reading user input -- being very careful parsing it */
 $datepattern = "/^([0-9]{4})-([0-9]{2})-([0-9]{2}) ([0-9]{2}):([0-9]{2})$/";
 if(isset($_POST['initdate']))
-{             
+{
     if(preg_match($datepattern, $_POST['initdate'], $regs))
     {
         $USER_init = mktime($regs[4], $regs[5], 0,$regs[2],$regs[3],$regs[1]);
@@ -107,7 +107,7 @@
     }
 }
 if(isset($_POST['finaldate']))
-{             
+{
     if(preg_match($datepattern, $_POST['finaldate'], $regs) == true)
     {
         $USER_final = mktime($regs[4], $regs[5], 0,$regs[2],$regs[3],$regs[1]);
@@ -115,8 +115,8 @@
     }
 }
 if(isset($_POST['level']))
-{             
-    if((is_numeric($_POST['level'])) && 
+{
+    if((is_numeric($_POST['level'])) &&
         ($_POST['level'] > 0) &&
         ($_POST['level'] < 16))
     {
@@ -151,7 +151,7 @@
 /* Getting location */
 if(isset($_POST['locationpattern']))
 {
-    $lcpattern = "/^[0-9a-zA-Z.: _|^!>\/\\-]{1,156}$/";    
+    $lcpattern = "/^[0-9a-zA-Z.: _|^!>\/\\-]{1,156}$/";
     if(preg_match($lcpattern, $_POST['locationpattern']) == true)
     {
         $LOCATION_pattern = $_POST['locationpattern'];
@@ -231,7 +231,7 @@
             $ossec_max_alerts_per_page = $_POST['max_alerts_per_page'];
         }
     }
-}    
+}
 
 
 
@@ -298,15 +298,15 @@
 


-    From:  From:  

  
     To:  

@@ -314,7 +314,7 @@ class="formText" />
     
 ';
 
-echo ' 
+echo '
Real time monitoring


@@ -374,8 +374,8 @@ class="formText" />
 echo '';
 
 /* Str pattern */
-echo '    
-    Pattern: 
+    Pattern: ';
 
 
@@ -409,25 +409,25 @@ class="formText" />
 
 
 /* Srcip pattern */
-echo '    
+echo '
     Srcip: 
-      ';
 
 /* Rule pattern */
 echo '
-    User: ';
 
 /* Location */
-echo '    
+echo '
     Location:
-      ';
 
 /* Rule pattern */
 echo '
-    Rule id: ';
 
 /* Max Alerts  */
@@ -437,12 +437,12 @@ class="formText" />
     value="'.$ossec_max_alerts_per_page.'" class="formText" />';
 
 
-/* Agent */    
+/* Agent */
 //foreach ($agent_list as $agent)
-    
+
 /* Final form */
 echo '
-                        
+    

 ';
 
@@ -457,14 +457,14 @@ class="formText" />
 echo '
 