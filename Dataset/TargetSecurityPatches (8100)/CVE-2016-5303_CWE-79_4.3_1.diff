30d5506c20d26efbb9942fbdc6f981a0bd333b97
horde@@horde
diff --git a/framework/Text_Filter/lib/Horde/Text/Filter/Xss.php b/framework/Text_Filter/lib/Horde/Text/Filter/Xss.php
index e8556783d85..419283e06fc 100644
--- a/framework/Text_Filter/lib/Horde/Text/Filter/Xss.php
+++ b/framework/Text_Filter/lib/Horde/Text/Filter/Xss.php
@@ -109,11 +109,19 @@ protected function _node($node)
 
             switch (Horde_String::lower($node->tagName)) {
             case 'a':
-                /* Strip out data URLs living in an A HREF element
+            case 'form':
+                /* Strip out data URLs living in link-like elements
                  * (Bug #8715). */
-                if ($node->hasAttribute('href') &&
-                    preg_match("/\s*data:/i", $node->getAttribute('href'))) {
-                    $remove[] = 'href';
+                if (Horde_String::lower($node->tagName) == 'form') {
+                    $attributes = array('action');
+                } else {
+                    $attributes = array('href', 'xlink:href');
+                }
+                foreach ($attributes as $attribute) {
+                    if ($node->hasAttribute($attribute) &&
+                        preg_match("/\s*data:/i", $node->getAttribute($attribute))) {
+                        $remove[] = $attribute;
+                    }
                 }
                 break;
 
diff --git a/framework/Text_Filter/test/Horde/Text/Filter/XssTest.php b/framework/Text_Filter/test/Horde/Text/Filter/XssTest.php
index 088ead9ea05..5093952c2d1 100644
--- a/framework/Text_Filter/test/Horde/Text/Filter/XssTest.php
+++ b/framework/Text_Filter/test/Horde/Text/Filter/XssTest.php
@@ -139,7 +139,10 @@ public function xssProvider()
             array('', ''),
             array(' <"" />', ''),
             array('', ''),
-            array($framedata, '')
+            array($framedata, ''),
+            array('', ''),
+            array('click', 'click'),
+            array('', ''),
         );
     }
 
