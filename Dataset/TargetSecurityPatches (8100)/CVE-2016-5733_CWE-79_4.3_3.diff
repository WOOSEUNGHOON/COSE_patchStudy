79661610f6f65443e0ec1e382a7240437f28436c
phpmyadmin@@phpmyadmin
diff --git a/libraries/plugins/transformations/abs/TextImageLinkTransformationsPlugin.php b/libraries/plugins/transformations/abs/TextImageLinkTransformationsPlugin.php
index ef534f296b2..d341f59da91 100644
--- a/libraries/plugins/transformations/abs/TextImageLinkTransformationsPlugin.php
+++ b/libraries/plugins/transformations/abs/TextImageLinkTransformationsPlugin.php
@@ -46,9 +46,14 @@ public static function getInfo()
      */
     public function applyTransformation($buffer, $options = array(), $meta = '')
     {
-        return ''
             . htmlspecialchars($buffer) . '';
diff --git a/libraries/plugins/transformations/abs/TextLinkTransformationsPlugin.php b/libraries/plugins/transformations/abs/TextLinkTransformationsPlugin.php
index 000b9d056be..a125b01e5fa 100644
--- a/libraries/plugins/transformations/abs/TextLinkTransformationsPlugin.php
+++ b/libraries/plugins/transformations/abs/TextLinkTransformationsPlugin.php
@@ -46,11 +46,14 @@ public static function getInfo()
      */
     public function applyTransformation($buffer, $options = array(), $meta = '')
     {
-        $append_part = (isset($options[2]) && $options[2]) ? '' : $buffer;
-
+        $url = (isset($options[0]) ? $options[0] : '') . ((isset($options[2]) && $options[2]) ? '' : $buffer);
+        $parsed = parse_url($url);
+        /* Do not allow javascript links */
+        if (isset($parsed['scheme']) && $parsed['scheme'] == 'javascript') {
+            return htmlspecialchars($url);
+        }
         return ''
