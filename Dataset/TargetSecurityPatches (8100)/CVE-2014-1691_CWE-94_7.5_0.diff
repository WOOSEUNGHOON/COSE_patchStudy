da6afc7e9f4e290f782eca9dbca794f772caccb3
horde@@horde
diff --git a/framework/Util/lib/Horde/Variables.php b/framework/Util/lib/Horde/Variables.php
index f9e77ebca19..1de39e6107c 100644
--- a/framework/Util/lib/Horde/Variables.php
+++ b/framework/Util/lib/Horde/Variables.php
@@ -61,7 +61,9 @@ static public function getDefaultVariables($sanitize = false)
      * Constructor.
      *
      * @param array $vars       The list of form variables (if null, defaults
-     *                          to PHP's $_REQUEST value).
+     *                          to PHP's $_REQUEST value). If '_formvars'
+     *                          exists, it must be a JSON encoded array that
+     *                          contains the list of allowed form variables.
      * @param string $sanitize  Sanitize the input variables?
      */
     public function __construct($vars = array(), $sanitize = false)
@@ -72,7 +74,7 @@ public function __construct($vars = array(), $sanitize = false)
         }
 
         if (isset($vars['_formvars'])) {
-            $this->_expected = @unserialize($vars['_formvars']);
+            $this->_expected = @json_decode($vars['_formvars'], true);
             unset($vars['_formvars']);
         }
 
diff --git a/framework/Util/package.xml b/framework/Util/package.xml
index c9be1069dde..2a3df6c7b6a 100644
--- a/framework/Util/package.xml
+++ b/framework/Util/package.xml
@@ -26,8 +26,8 @@
  2013-05-06
19:34:35

-  2.2.3
-  2.2.0
+  2.3.0
+  2.3.0


stable
@@ -35,7 +35,7 @@
  
LGPL-2.1

-* 
+* [mms] SECURITY: '_formvars' form input must now be JSON encoded, not PHP serialized.
  


@@ -116,6 +116,9 @@
    
iconv

+   
+    json
+   

mbstring

@@ -619,15 +622,15 @@ Converted to package.xml 2.0 for pear.horde.org
   


-    2.2.3
-    2.2.0
+    2.3.0
+    2.3.0

stable
stable
2013-05-06
LGPL-2.1

-* 
+* [mms] SECURITY: '_formvars' form input must now be JSON encoded, not PHP serialized.
    


