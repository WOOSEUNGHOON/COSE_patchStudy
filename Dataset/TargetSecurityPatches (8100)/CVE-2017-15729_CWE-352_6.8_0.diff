867618110feb836e168435548d6c2cbb7c65eda3
thorsten@@phpMyFAQ
diff --git a/phpmyfaq/admin/glossary.add.php b/phpmyfaq/admin/glossary.add.php
index e7fbe5b7ad..0e3be840a5 100644
--- a/phpmyfaq/admin/glossary.add.php
+++ b/phpmyfaq/admin/glossary.add.php
@@ -41,6 +41,8 @@
 if ($user->perm->checkRight($user->getUserId(), 'addglossary')) {
     ?>
                 
+                    
+
                     
:
diff --git a/phpmyfaq/admin/glossary.edit.php b/phpmyfaq/admin/glossary.edit.php
index 304896a661..5ce20fc4c5 100644
--- a/phpmyfaq/admin/glossary.edit.php
+++ b/phpmyfaq/admin/glossary.edit.php
@@ -43,6 +43,7 @@
     $glossaryItem = $glossary->getGlossaryItem($id);
     ?>
                 
+                    


diff --git a/phpmyfaq/admin/glossary.main.php b/phpmyfaq/admin/glossary.main.php
index 081f10b05a..2941bb8863 100644
--- a/phpmyfaq/admin/glossary.main.php
+++ b/phpmyfaq/admin/glossary.main.php
@@ -9,11 +9,9 @@
  * obtain one at http://mozilla.org/MPL/2.0/.
  *
  * @category  phpMyFAQ
- *
  * @author    Thorsten Rinne 
  * @copyright 2005-2017 phpMyFAQ Team
  * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0
- *
  * @link      http://www.phpmyfaq.de
  * @since     2005-09-15
  */
@@ -42,12 +40,26 @@
         

perm->checkRight($user->getUserId(), 'addglossary') ||
     $user->perm->checkRight($user->getUserId(), 'editglossary') ||
     $user->perm->checkRight($user->getUserId(), 'delglossary')) {
     $glossary = new PMF_Glossary($faqConfig);
 
-    if ('saveglossary' == $action && $user->perm->checkRight($user->getUserId(), 'addglossary')) {
+    if ('saveglossary' == $action && $user->perm->checkRight($user->getUserId(), 'addglossary') && $csrfCheck) {
         $item = PMF_Filter::filterInput(INPUT_POST, 'item', FILTER_SANITIZE_SPECIAL_CHARS);
         $definition = PMF_Filter::filterInput(INPUT_POST, 'definition', FILTER_SANITIZE_SPECIAL_CHARS);
         if ($glossary->addGlossaryItem($item, $definition)) {
@@ -61,7 +73,7 @@
         }
     }
 
-    if ('updateglossary' == $action && $user->perm->checkRight($user->getUserId(), 'editglossary')) {
+    if ('updateglossary' == $action && $user->perm->checkRight($user->getUserId(), 'editglossary') && $csrfCheck) {
         $id = PMF_Filter::filterInput(INPUT_POST, 'id', FILTER_VALIDATE_INT);
         $item = PMF_Filter::filterInput(INPUT_POST, 'item', FILTER_SANITIZE_SPECIAL_CHARS);
         $definition = PMF_Filter::filterInput(INPUT_POST, 'definition', FILTER_SANITIZE_SPECIAL_CHARS);
@@ -76,7 +88,7 @@
         }
     }
 
-    if ('deleteglossary' == $action && $user->perm->checkRight($user->getUserId(), 'editglossary')) {
+    if ('deleteglossary' == $action && $user->perm->checkRight($user->getUserId(), 'editglossary') && $csrfCheckDelete) {
         $id = PMF_Filter::filterInput(INPUT_GET, 'id', FILTER_VALIDATE_INT);
         if ($glossary->deleteGlossaryItem($id)) {
             echo 'Ã—';
@@ -111,10 +123,12 @@
             $items['definition']
         );
         printf(
-            '',
+            '',
             $PMF_LANG['ad_user_del_3'],
             '?action=deleteglossary&id=',
-            $items['id']
+            $items['id'],
+            '&csrf=',
+            $user->getCsrfTokenFromSession()
         );
         printf(
             '',
