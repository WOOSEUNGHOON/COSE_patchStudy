e2a665e13b7de82a71c9bbb77575d15131b722be
s9y@@Serendipity
diff --git a/docs/NEWS b/docs/NEWS
index c42e415b4..0c4a813dd 100644
--- a/docs/NEWS
+++ b/docs/NEWS
@@ -1,9 +1,12 @@
-Version 2.1 ()
+Version 2.1 (November 28th, 2016)
 ------------------------------------------------------------------------
 
     * [Security] Enhanced media upload check to also check redirects
       for local files, thanks to Xu Yue (again!)
 
+    * [Security] Prevent XSS in adding category and directory names, 
+      thanks to Edric Teo @smarterbitbybit.
+
 Version 2.1-beta2 (September 26th, 2016)
 ------------------------------------------------------------------------
     * Improved backend accessibility by hiding iconfont icons for
diff --git a/include/admin/images.inc.php b/include/admin/images.inc.php
index 085455e40..d4802e09a 100644
--- a/include/admin/images.inc.php
+++ b/include/admin/images.inc.php
@@ -550,7 +550,7 @@
 
         /* TODO: check if directory already exist */
         if (is_dir($nd) || @mkdir($nd)) {
-            $data['print_DIRECTORY_CREATED'] = sprintf(DIRECTORY_CREATED, $serendipity['POST']['name']);
+            $data['print_DIRECTORY_CREATED'] = sprintf(DIRECTORY_CREATED, $new_dir);
             @umask(0000);
             @chmod($serendipity['serendipityPath'] . $serendipity['uploadPath'] . $new_dir, 0777);
 
diff --git a/serendipity_config.inc.php b/serendipity_config.inc.php
index 4e4d79506..978c31f86 100644
--- a/serendipity_config.inc.php
+++ b/serendipity_config.inc.php
@@ -47,7 +47,7 @@
 }
 
 // The version string
-$serendipity['version'] = '2.1-beta2';
+$serendipity['version'] = '2.1-beta3';
 
 
 // Setting this to 'false' will enable debugging output. All alpha/beta/cvs snapshot versions will emit debug information by default. To increase the debug level (to enable Smarty debugging), set this flag to 'debug'.
diff --git a/templates/2k11/admin/category.inc.tpl b/templates/2k11/admin/category.inc.tpl
index 4948adaca..2f5ab23b7 100644
--- a/templates/2k11/admin/category.inc.tpl
+++ b/templates/2k11/admin/category.inc.tpl
@@ -54,7 +54,7 @@
             

{$CONST.NAME}
-                    
+                    


@@ -74,7 +74,7 @@
                         {$CONST.NO_CATEGORY}
                     {foreach $categories as $cat}
                         {if $cat.categoryid == $cid}{continue}{/if}
-                        {for $i=1 to $cat.depth} {/for} {$cat.category_name}
+                        {for $i=1 to $cat.depth} {/for} {$cat.category_name|escape}
                     {/foreach}
                     

