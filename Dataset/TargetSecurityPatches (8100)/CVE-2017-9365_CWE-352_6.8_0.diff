c17d09b05d9c20c214ee2f4fbb52f7307a7b4b6f
bigtreecms@@BigTree-CMS
diff --git a/core/admin/auto-modules/forms/_locked.php b/core/admin/auto-modules/forms/_locked.php
index 20dd47e5c..689061e4b 100755
--- a/core/admin/auto-modules/forms/_locked.php
+++ b/core/admin/auto-modules/forms/_locked.php
@@ -13,7 +13,7 @@
 		


-		Unlock
+		Unlock
 		 
 		Cancel

diff --git a/core/admin/auto-modules/forms/edit.php b/core/admin/auto-modules/forms/edit.php
index 5d86d7fa1..e4d448560 100755
--- a/core/admin/auto-modules/forms/edit.php
+++ b/core/admin/auto-modules/forms/edit.php
@@ -1,6 +1,12 @@
 verifyCSRFToken();
+		$force = true;
+	} else {
+		$force = false;
+	}
+	
 	$admin->lockCheck($bigtree["form"]["table"],$bigtree["edit_id"],"admin/auto-modules/forms/_locked.php",$force);
 	
 	$pending_entry = BigTreeAutoModule::getPendingItem($bigtree["form"]["table"],$bigtree["edit_id"]);
diff --git a/core/admin/modules/pages/_locked.php b/core/admin/modules/pages/_locked.php
index bd5218331..49c158778 100755
--- a/core/admin/modules/pages/_locked.php
+++ b/core/admin/modules/pages/_locked.php
@@ -12,6 +12,6 @@
 	
Cancel
 		 
-		Unlock
+		Unlock


\ No newline at end of file
diff --git a/core/admin/modules/pages/edit.php b/core/admin/modules/pages/edit.php
index dadb2bda2..ed17edf07 100755
--- a/core/admin/modules/pages/edit.php
+++ b/core/admin/modules/pages/edit.php
@@ -6,7 +6,13 @@
 	include BigTree::path("admin/modules/pages/_properties.php");
 	
 	// Check for a page lock
-	$force = isset($_GET["force"]) ? $_GET["force"] : false;
+	if (!empty($_GET["force"])) {
+		$admin->verifyCSRFToken();
+		$force = true;
+	} else {
+		$force = false;
+	}
+	
 	$admin->lockCheck("bigtree_pages",$page["id"],"admin/modules/pages/_locked.php",$force);
 	
 	// Grab template information
diff --git a/core/admin/modules/pages/revisions.php b/core/admin/modules/pages/revisions.php
index 9b0b183f7..91b115b54 100755
--- a/core/admin/modules/pages/revisions.php
+++ b/core/admin/modules/pages/revisions.php
@@ -32,7 +32,13 @@
 	}
 	
 	// Check for a page lock
-	$force = isset($_GET["force"]) ? $_GET["force"] : false;
+	if (!empty($_GET["force"])) {
+		$admin->verifyCSRFToken();
+		$force = true;
+	} else {
+		$force = false;
+	}
+
 	$lock_id = $admin->lockCheck("bigtree_pages",$page["id"],"admin/modules/pages/_locked.php",$force);
 	
 	// See if there's a draft copy.
