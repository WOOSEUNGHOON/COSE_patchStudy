80a15487
mantisbt@@mantisbt
diff --git a/plugins/XmlImportExport/XmlImportExport.php b/plugins/XmlImportExport/XmlImportExport.php
index 63e254e8f8..20ea3c23d8 100644
--- a/plugins/XmlImportExport/XmlImportExport.php
+++ b/plugins/XmlImportExport/XmlImportExport.php
@@ -39,7 +39,7 @@ class XmlImportExportPlugin extends MantisPlugin {
 	function register( ) {
 		$this->name = plugin_lang_get( 'title' );
 		$this->description = plugin_lang_get( 'description' );
-		$this->page = '';
+		$this->page = "config_page";
 
 		$this->version = '1.0';
 		$this->requires = array(
@@ -54,6 +54,17 @@ function register( ) {
 	/**
 	 * Default plugin configuration.
 	 */
+	public function config() {
+		return array(
+			"import_threshold" => ADMINISTRATOR,
+			"export_threshold" => DEVELOPER,
+		);
+	}
+
+	/**
+	 * Plugin hooks
+	 * @return array
+	 */
 	function hooks( ) {
 		$hooks = array(
 			'EVENT_MENU_MANAGE' => 'import_issues_menu',
@@ -67,6 +78,9 @@ function import_issues_menu( ) {
 	}
 
 	function export_issues_menu( ) {
+		if( !access_has_project_level( plugin_config_get( 'export_threshold' ) ) ) {
+			return array();
+		}
 		return array( '' . plugin_lang_get( 'export' ) . '', );
 	}
 
diff --git a/plugins/XmlImportExport/lang/strings_english.txt b/plugins/XmlImportExport/lang/strings_english.txt
index 775ad76e22..e595228dae 100644
--- a/plugins/XmlImportExport/lang/strings_english.txt
+++ b/plugins/XmlImportExport/lang/strings_english.txt
@@ -35,7 +35,14 @@ $s_plugin_XmlImportExport_description = 'Adds XML based import and export capabi
 $s_plugin_XmlImportExport_import = 'Import issues';
 $s_plugin_XmlImportExport_export = 'XML Export';
 
+$s_plugin_XmlImportExport_config_title = 'XML Import/Export Access Levels Configuration';
+$s_plugin_XmlImportExport_import_threshold = 'Import issues';
+$s_plugin_XmlImportExport_export_threshold = 'Export issues';
+
+$s_plugin_XmlImportExport_action_update = 'Update';
+
 $s_plugin_XmlImportExport_importing_in_project = 'Importing issues in project:';
+
 $s_plugin_XmlImportExport_import_options = 'Import options';
 
 $s_plugin_XmlImportExport_cross_references = 'Cross references';
diff --git a/plugins/XmlImportExport/pages/config.php b/plugins/XmlImportExport/pages/config.php
new file mode 100644
index 0000000000..19587c86eb
--- /dev/null
+++ b/plugins/XmlImportExport/pages/config.php
@@ -0,0 +1,27 @@
+
+
+
+
+
+
+
+
+
+
+
+>
+
+
+
+
+>
+
+
+
+
+
+"/>
+
+
+
+
+
+.
 
+access_ensure_project_level( plugin_config_get( 'import_threshold' ) );
+
 auth_reauthenticate( );
 
 html_page_top( plugin_lang_get( 'import' ) );
