1ca6a3e5168c200763fa46d8aa7e698d0b757e7e
OSGeo@@gdal
diff --git a/frmts/pcidsk/sdk/segment/cpcidskbinarysegment.cpp b/frmts/pcidsk/sdk/segment/cpcidskbinarysegment.cpp
index b64186e89522..0a05b47bac92 100644
--- a/frmts/pcidsk/sdk/segment/cpcidskbinarysegment.cpp
+++ b/frmts/pcidsk/sdk/segment/cpcidskbinarysegment.cpp
@@ -31,6 +31,7 @@
 #include "pcidsk_exception.h"
 #include "core/pcidsk_utils.h"
 
+#include 
 #include 
 #include 
 #include 
@@ -73,8 +74,12 @@ void CPCIDSKBinarySegment::Load()
     if (loaded_) {
         return;
     }
+    if( data_size - 1024 > static_cast(std::numeric_limits::max()) )
+    {
+        return ThrowPCIDSKException("too large data_size");
+    }
 
-    seg_data.SetSize((int)data_size - 1024);
+    seg_data.SetSize((int)(data_size - 1024));
 
     ReadFromFile(seg_data.buffer, 0, data_size - 1024);
 
