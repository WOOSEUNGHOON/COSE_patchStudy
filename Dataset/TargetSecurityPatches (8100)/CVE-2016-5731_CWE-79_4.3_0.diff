94cf3864254ffaf3a69e97d8fc454888368b94ab
phpmyadmin@@phpmyadmin
diff --git a/examples/openid.php b/examples/openid.php
index a15189b37af..8ef34e9ee34 100644
--- a/examples/openid.php
+++ b/examples/openid.php
@@ -63,6 +63,16 @@ function Show_page($contents)
     \n";
+    $contents .= "" . htmlspecialchars($e->getMessage()) . "\n";
+    $contents .= "";
+    Show_page($contents);
+    exit;
+}
+
+
 /* Need to have cookie visible from parent directory */
 session_set_cookie_params(0, '/', '', false);
 /* Create signon session */
@@ -110,11 +120,7 @@ function Show_page($contents)
 try {
     $o = new OpenID_RelyingParty($returnTo, $realm, $identifier);
 } catch (Exception $e) {
-    $contents = "\n";
-    $contents .= "" . htmlspecialchars($e->getMessage()) . "\n";
-    $contents .= "";
-    Show_page($contents);
-    exit;
+    Die_error($e);
 }
 
 /* Redirect to OpenID provider */
@@ -122,11 +128,7 @@ function Show_page($contents)
     try {
         $authRequest = $o->prepare();
     } catch (Exception $e) {
-        $contents = "\n";
-        $contents .= "" . htmlspecialchars($e->getMessage()) . "\n";
-        $contents .= "";
-        Show_page($contents);
-        exit;
+        Die_error($e);
     }
 
     $url = $authRequest->getAuthorizeURL();
@@ -143,7 +145,11 @@ function Show_page($contents)
     }
 
     /* Check reply */
-    $message = new OpenID_Message($queryString, OpenID_Message::FORMAT_HTTP);
+    try {
+        $message = new OpenID_Message($queryString, OpenID_Message::FORMAT_HTTP);
+    } catch (Exception $e) {
+        Die_error($e);
+    }
 
     $id = $message->get('openid.claimed_id');
 
