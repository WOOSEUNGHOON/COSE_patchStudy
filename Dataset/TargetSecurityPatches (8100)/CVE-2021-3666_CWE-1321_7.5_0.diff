d46ca622560f7c9a033cd9321c61e92558150d63
fiznool@@body-parser-xml
diff --git a/index.js b/index.js
index 619ad7a..0dec27b 100644
--- a/index.js
+++ b/index.js
@@ -43,7 +43,16 @@ module.exports = function (bodyParser) {
             return next(err);
           }
 
-          req.body = xml || req.body;
+          if (xml) {
+            // Guard against prototype pollution
+            delete xml.__proto__;
+            delete xml.constructor;
+            delete xml.prototype;
+
+            // Set result on the request body
+            req.body = xml;
+          }
+
           next();
         });
       });
diff --git a/test.js b/test.js
index 5533830..3bcca83 100644
--- a/test.js
+++ b/test.js
@@ -130,4 +130,31 @@ describe('XML Body Parser', function () {
       .send('xtesttest')
       .expect(400, done);
   });
+
+  it('should not set/change prototype using __proto__', function (done) {
+    createServer();
+    request(app)
+      .post('/')
+      .set('Content-Type', 'application/xml')
+      .send('<__proto__>Bob')
+      .expect(200, { parsed: {} }, done);
+  });
+
+  it('should not set/change using prototype', function (done) {
+    createServer();
+    request(app)
+      .post('/')
+      .set('Content-Type', 'application/xml')
+      .send('Bob')
+      .expect(200, { parsed: {} }, done);
+  });
+
+  it('should not set/change using constructor', function (done) {
+    createServer();
+    request(app)
+      .post('/')
+      .set('Content-Type', 'application/xml')
+      .send('Bob')
+      .expect(200, { parsed: {} }, done);
+  });
 });
