59cc65411f02c7e39a270fda3ecb4966d7b48d41
mnoorenberghe@@ZoneMinder
diff --git a/web/skins/classic/views/plugin.php b/web/skins/classic/views/plugin.php
index 7b4cf85ca6..814416058e 100644
--- a/web/skins/classic/views/plugin.php
+++ b/web/skins/classic/views/plugin.php
@@ -36,7 +36,8 @@
    return;
 }
 $monitor = dbFetchMonitor ( $mid );
-$plugin = $_REQUEST['pl'];
+// Only allow certain filename characters (not including a period) to prevent directory traversal.
+$plugin = preg_replace('/[^-a-zA-Z0-9]/', '', $_REQUEST['pl']);
 
 $plugin_path = dirname(ZM_PLUGINS_CONFIG_PATH)."/".$plugin;
 
@@ -103,7 +104,7 @@ function pLang($name)
 


-        -   -  
+        -   -  



@@ -111,7 +112,7 @@ function pLang($name)
         


-        
+        


