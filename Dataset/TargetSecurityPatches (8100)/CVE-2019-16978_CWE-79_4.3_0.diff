83622c4ee1d9dd1913e9fb01ce8f060b46a5768a
fusionpbx@@fusionpbx
diff --git a/app/devices/device_settings.php b/app/devices/device_settings.php
index c83237e50a..1aa4161886 100644
--- a/app/devices/device_settings.php
+++ b/app/devices/device_settings.php
@@ -17,34 +17,43 @@
 
  The Initial Developer of the Original Code is
  Mark J Crane 
- Portions created by the Initial Developer are Copyright (C) 2008-2012
+ Portions created by the Initial Developer are Copyright (C) 2008-2019
  the Initial Developer. All Rights Reserved.
 
  Contributor(s):
  Mark J Crane 
 */
-require_once "root.php";
-require_once "resources/require.php";
-require_once "resources/check_auth.php";
-if (permission_exists('device_setting_view')) {
-	//access granted
-}
-else {
-	echo "access denied";
-	exit;
-}
+
+//includes
+	require_once "root.php";
+	require_once "resources/require.php";
+	require_once "resources/check_auth.php";
+
+//check permissions
+	if (permission_exists('device_setting_view')) {
+		//access granted
+	}
+	else {
+		echo "access denied";
+		exit;
+	}
 
 //add multi-lingual support
 	$language = new text;
 	$text = $language->get();
 
-require_once "resources/header.php";
-require_once "resources/paging.php";
+//additional includes
+	require_once "resources/header.php";
+	require_once "resources/paging.php";
 
 //get variables used to control the order
 	$order_by = $_GET["order_by"];
 	$order = $_GET["order"];
-	$device_uuid = $_GET["id"];
+
+//get the uuid
+	if (is_uuid($_GET['id'])) {
+		$device_uuid = $_GET['id'];
+	}
 
 //show the content
 	echo "\n";
@@ -107,7 +116,7 @@
 				echo th_order_by('device_setting_description', $text['label-description'], $order_by, $order);
 				echo "\n";
 				if (permission_exists('device_setting_add')) {
-					echo "	$v_link_label_add\n";
+					echo "	$v_link_label_add\n";
 				}
 				else {
 					echo "	Â \n";
@@ -161,4 +170,4 @@
 
 //include the footer
 	require_once "resources/footer.php";
-?>
\ No newline at end of file
+?>
