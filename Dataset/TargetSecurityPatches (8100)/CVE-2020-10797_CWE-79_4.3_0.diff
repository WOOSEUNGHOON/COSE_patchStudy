cc3990a334059018b004c91eeb66c147d8afe83d
pfsense@@pfsense
diff --git a/src/usr/local/www/diag_ping.php b/src/usr/local/www/diag_ping.php
index 096fac536f0..995903ccdf9 100644
--- a/src/usr/local/www/diag_ping.php
+++ b/src/usr/local/www/diag_ping.php
@@ -68,6 +68,9 @@
 	if (($ipproto == "ipv6") && is_ipaddrv4($host)) {
 		$input_errors[] = gettext("When using IPv6, the target host must be an IPv6 address or hostname.");
 	}
+	if (!is_ipaddr($host) && !is_hostname($host)) {
+		$input_errors[] = gettext("Hostname must be a valid hostname or IP address.");
+	}
 
 	if (!$input_errors) {
 		if ($_POST) {
@@ -185,7 +188,7 @@
 		

-			
+			




' . $result . '');
+	print('' . htmlspecialchars($result) . '');
 ?>
 		

