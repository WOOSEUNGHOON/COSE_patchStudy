162ae709162be3e6c4d942313a278ca5cbdb8e92
JamesHeinrich@@phpThumb
diff --git a/demo/phpThumb.demo.showpic.php b/demo/phpThumb.demo.showpic.php
index d24f160..a8d9a9b 100644
--- a/demo/phpThumb.demo.showpic.php
+++ b/demo/phpThumb.demo.showpic.php
@@ -76,47 +76,47 @@ function CrossBrowserResizeInnerWindowTo(newWidth, newHeight) {
 
 $value) {
+	if (!in_array($key, $allowedGETparameters)) {
+		continue;
+	}
 	if (is_array($value)) {
+		if ($key != 'fltr') {
+			continue;
+		}
 		foreach ($value as $key2 => $value2) {
-			$additionalparameters[] = $key.'[]='.SafeStripSlashes($value2);
+			@$additionalparameters[$key][] = preg_replace('#[^A-Za-z0-9\\. _:/]#', '', $value2);
 		}
 	} else {
-		$additionalparameters[] = $key.'='.SafeStripSlashes($value);
+		$additionalparameters[$key] = preg_replace('#[^A-Za-z0-9\\. _:/]#', '', $value);
 	}
 }
-//$imagesrc = $phpThumbLocation.implode('&', $additionalparameters);
-$imagesrc = phpThumbURL(implode($PHPTHUMB_CONFIG['config_high_security_url_separator'], $additionalparameters), $phpThumbLocation);
+$imagesrc = phpThumbURL($additionalparameters, $phpThumbLocation);
 
 echo '';
-?>
-
-
 
-';
 
 if (!empty($_GET['src'])) {
 
@@ -127,7 +127,7 @@ function SafeStripSlashes($string) {
 } else {
 
 	echo '';
-	echo 'Usage:'.$_SERVER['PHP_SELF'].'?src=filename&title=Picture+Title';
+	echo 'Usage:'.basename(__FILE__).'?src=filename&title=Picture+Title';
 	echo '';
 
 }
