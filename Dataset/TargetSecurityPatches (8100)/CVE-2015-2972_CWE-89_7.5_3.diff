1b8234706e1294f41df42f3d1ccb71b983ffbe23
sysphonic@@thetis
diff --git a/app/controllers/application_controller.rb b/app/controllers/application_controller.rb
index 9b83a1a..b08bd83 100644
--- a/app/controllers/application_controller.rb
+++ b/app/controllers/application_controller.rb
@@ -99,7 +99,12 @@ def gate_process
 
     HistoryHelper.keep_last(request)
 
-    @login_user = User.find(session[:login_user_id])
+    SqlHelper.validate_token([session[:login_user_id]])
+    begin
+      @login_user = User.find(session[:login_user_id])
+    rescue => evar
+      @login_user = nil
+    end
 
     begin
       if @login_user.nil? \
