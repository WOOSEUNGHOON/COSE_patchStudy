762f98ab4137749d0993612b4e3544a4207e78a1
Dolibarr@@dolibarr
diff --git a/htdocs/lib/security.lib.php b/htdocs/lib/security.lib.php
index 4212cc12529..0a8ceafa2a1 100644
--- a/htdocs/lib/security.lib.php
+++ b/htdocs/lib/security.lib.php
@@ -181,7 +181,7 @@ function dol_loginfunction($langs,$conf,$mysoc)
 	}
 
 	// Login
-	$login = (!empty($lastuser)?$lastuser:(GETPOST("username")?GETPOST("username"):$demologin));
+	$login = (!empty($lastuser)?$lastuser:(GETPOST("username","alpha",2)?GETPOST("username","alpha",2):$demologin));
 	$password = $demopassword;
 
 	// Show logo (search in order: small company logo, large company logo, theme logo, common logo)
diff --git a/htdocs/main.inc.php b/htdocs/main.inc.php
index e6796b41870..c6ee7bd423e 100644
--- a/htdocs/main.inc.php
+++ b/htdocs/main.inc.php
@@ -76,6 +76,9 @@ function test_sql_and_script_inject($val,$get)
 	$sql_inj += preg_match('/(\.\.%2f)+/i', $val);
 	// For XSS Injection done by adding javascript with script
 	$sql_inj += preg_match('/