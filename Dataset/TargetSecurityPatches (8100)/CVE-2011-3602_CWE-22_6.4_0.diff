92e22ca23e52066da2258df8c76a2dca8a428bcc
reubenhwk@@radvd
diff --git a/device-linux.c b/device-linux.c
index 3bb0beb6..709eebc6 100644
--- a/device-linux.c
+++ b/device-linux.c
@@ -243,6 +243,10 @@ set_interface_var(const char *iface,
 	if (snprintf(spath, sizeof(spath), var, iface) >= sizeof(spath))
 		return -1;
 
+	/* No path traversal */
+	if (strstr(name, "..") || strchr(name, '/'))
+		return -1;
+
 	if (access(spath, F_OK) != 0)
 		return -1;
 
