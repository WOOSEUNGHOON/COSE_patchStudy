5c3e4f96ff0ef6b91a3f0aa64eb28197c5cf5435
thorsten@@phpMyFAQ
diff --git a/phpmyfaq/admin/attachment.php b/phpmyfaq/admin/attachment.php
index 5312273b8d..f1fcb0e5b6 100644
--- a/phpmyfaq/admin/attachment.php
+++ b/phpmyfaq/admin/attachment.php
@@ -139,7 +139,11 @@
     

 $faqConfig->get('records.maxAttachmentSize'))) {
+    if (
+        is_uploaded_file($_FILES['userfile']['tmp_name']) &&
+        !($_FILES['userfile']['size'] > $faqConfig->get('records.maxAttachmentSize')) &&
+        $_FILES['userfile']['type'] !== "text/html"
+    ) {
         $att = PMF_Attachment_Factory::create();
         $att->setRecordId($recordId);
         $att->setRecordLang($recordLang);
