0600ebe59c3e82cd012def77ca9ca1918da74a71
facebook@@proxygen
diff --git a/proxygen/lib/http/session/HTTPSession.cpp b/proxygen/lib/http/session/HTTPSession.cpp
index 71152b24f..95b34c6e4 100644
--- a/proxygen/lib/http/session/HTTPSession.cpp
+++ b/proxygen/lib/http/session/HTTPSession.cpp
@@ -1349,6 +1349,10 @@ void HTTPSession::onCertificateRequest(uint16_t requestId,
   DestructorGuard dg(this);
   VLOG(4) << "CERTIFICATE_REQUEST on" << *this << ", requestId=" << requestId;
 
+  if (!secondAuthManager_) {
+    return;
+  }
+
   std::pair> authenticator;
   auto fizzBase = getTransport()->getUnderlyingTransport();
   if (fizzBase) {
@@ -1382,6 +1386,10 @@ void HTTPSession::onCertificate(uint16_t certId,
   DestructorGuard dg(this);
   VLOG(4) << "CERTIFICATE on" << *this << ", certId=" << certId;
 
+  if (!secondAuthManager_) {
+    return;
+  }
+
   bool isValid = false;
   auto fizzBase = getTransport()->getUnderlyingTransport();
   if (fizzBase) {
