6ab0992e5472ae3f9bef0d2ced41030655d9d2bc
openstack@@glance
diff --git a/glance/api/v1/images.py b/glance/api/v1/images.py
index 9bedf204df..1a8eac8b54 100644
--- a/glance/api/v1/images.py
+++ b/glance/api/v1/images.py
@@ -727,6 +727,15 @@ def delete(self, req, id):
                                 content_type="text/plain")
 
         image = self.get_image_meta_or_404(req, id)
+
+        if not (req.context.is_admin
+                or image['owner'] == None
+                or image['owner'] == req.context.owner):
+            msg = _("Unable to delete image you do not own")
+            logger.debug(msg)
+            raise HTTPForbidden(msg, request=req,
+                                content_type="text/plain")
+
         if image['protected']:
             msg = _("Image is protected")
             logger.debug(msg)
